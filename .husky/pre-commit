#!/bin/sh
. "$(dirname "$0")/_/husky.sh"

if [ "$ALLOW_EMPTY_COMMIT" = "1" ]; then
  npx lint-staged --allow-empty
else
  npx lint-staged
fi

# Check for large files in staged changes (BLOCKS commit if new code violates Quality Gate)
node scripts/ci/check-large-files.cjs

# Check for known Sonar patterns (WARNS but does not block - shift left)
node scripts/ci/check-sonar-patterns.cjs

# Check if schema.md needs updating after migration changes
node scripts/ci/check-schema-sync.cjs

# Check for new dependencies (WARNS - dependency hygiene reminder)
node scripts/ci/check-new-dependencies.cjs
