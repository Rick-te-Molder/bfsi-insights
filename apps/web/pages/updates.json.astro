---
export const prerender = true;

import { getAllPublications } from '../lib/supabase';

const publications = await getAllPublications();

const latest = publications.slice(0, 20).map((item) => ({
  title: item.title,
  url: item.url,
  date_added: item.date_added,
  last_edited: (item as any).last_edited,
  source_name: item.source_name,
  audience: item.audience,
  industry: item.industry,
  topic: item.topic,
  content_type: item.content_type,
  geography: item.geography,
}));

Astro.response.headers.set('Content-Type', 'application/json; charset=utf-8');
---

{JSON.stringify({ items: latest }, null, 2)}
